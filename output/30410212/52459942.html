<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link rel="stylesheet" type="text/css" href="http://storage.360buyimg.com/ebooks/9fd8bb77eb40456b746aaae41785499a_new_.css" /><title>第4章 内置指令</title></head><body><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t21631/334/203553551/35584/1837decc/5b03d541Na941da6c.jpg" class="fullscreen" alt="" href="./image/Figure-04.jpg" /></p><p class="sectionTitle biaoti3"><a id="sec001"></a>4.1 简介</p><p class="content">Angular提供了若干内置指令。在本章中，我们将探讨每一个内置指令并通过示例教会你如何使用它们。</p><p class="reference"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t20827/10/215994487/12231/293f6125/5b03d541Ndff69dec.jpg" class="inline1" alt="" href="./image/a-3.jpg" />　内置指令是已经导入过的，你的组件可以直接使用它们。因此，不用像你自己的组件一样把它们作为指令导入进来。</p><p class="sectionTitle biaoti3"><a id="sec002"></a>4.2 ngIf</p><p class="content">如果你希望根据一个条件来决定显示或隐藏一个元素，可以使用ngIf指令。这个条件是由你传给指令的<b>表达式</b>的结果决定的。</p><p class="content">如果表达式的结果返回的是一个假值，那么元素会从DOM上被移除。</p><p class="content">下面是一些例子：</p><p class="daima">&lt;div *ngIf="false"&gt;&lt;/div&gt;　　　　 &lt;！—— never displayed ——&gt;</p><p class="daima">&lt;div *ngIf="a &gt; b"&gt;&lt;/div&gt;　　　　 &lt;！—— displayed if a is more than b ——&gt;</p><p class="daima">&lt;div *ngIf="str == 'yes'"&gt;&lt;/div&gt;　&lt;！—— displayed if str holds the string "yes" ——&gt;</p><p class="daima">&lt;div *ngIf="myFunc（）"&gt;&lt;/div&gt;　　　&lt;！—— displayed if myFunc returns a true value ——&gt;</p><p class="reference"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t20827/10/215994487/12231/293f6125/5b03d541Ndff69dec.jpg" class="inline1" alt="" href="./image/a-3.jpg" />　如果你有AngularJS的经验，那么大概以前已经用过ngIf指令了。你可以把它当作AngularJS中ng-if的替代品。但另一方面，Angular并没有为AngularJS中的ng-show指令提供内置的替代品。那么，如果你只是想改变一个元素的CSS可见性，就应该使用ngStyle或class指令。本章稍后会介绍它们。</p><p class="sectionTitle biaoti3"><a id="sec003"></a>4.3 ngSwitch</p><p class="content">有时候你需要根据一个给定的条件来渲染不同的元素。</p><p class="content">遇到这种情况时，你可能会像下面这样多次使用ngIf：</p><p class="daima">&lt;div class="container"&gt;</p><p class="daima">　&lt;div *ngIf="myVar == 'A'"&gt;Var is A&lt;/div&gt;</p><p class="daima">　&lt;div *ngIf="myVar == 'B'"&gt;Var is B&lt;/div&gt;</p><p class="daima">　&lt;div *ngIf="myVar！= 'A' &amp;&amp; myVar！= 'B'"&gt;Var is something else&lt;/div&gt;</p><p class="daima">&lt;/div&gt;</p><p class="content">如你所见，当myVar的值既不是A也不是B时，代码将变得相当繁琐，其实我们真正想表达的只是一个else而已。随着我们添加的值越来越多，ngIf条件也会变得越来越复杂。</p><p class="content">为了说明这种增长的复杂性，假设我们想要处理一个新的值C。</p><p class="content">为了达到目的，我们不仅要添加一个使用ngIf的新元素，而且要修改最后一种情况：</p><p class="daima">&lt;div class="container"&gt;</p><p class="daima">　&lt;div *ngIf="myVar == 'A'"&gt;Var is A&lt;/div&gt;</p><p class="daima">　&lt;div *ngIf="myVar == 'B'"&gt;Var is B&lt;/div&gt;</p><p class="daima">　&lt;div *ngIf="myVar == 'C'"&gt;Var is C&lt;/div&gt;</p><p class="daima">　&lt;div *ngIf="myVar！= 'A' &amp;&amp; myVar！= 'B' &amp;&amp; myVar！= 'C'"&gt;Var is something else&lt;/div&gt;</p><p class="daima">&lt;/div&gt;</p><p class="content">对于这种情况，Angular引入了ngSwitch指令。</p><p class="content">如果你熟悉switch语句的话，应该会觉得似曾相识。</p><p class="content">指令背后的思想也是一样的：对表达式进行一次求值，然后根据其结果来决定如何显示指令内的嵌套元素。</p><p class="content">一旦有了结果，我们就可以：</p><p class="content">●使用ngSwitchCase指令描述已知结果；</p><p class="content">●使用ngSwitchDefault指令处理所有其他未知情况。</p><p class="content">让我们使用这组新的指令来重写之前的例子：</p><p class="daima">&lt;div class="container" [ngSwitch]="myVar"&gt;</p><p class="daima">　&lt;div *ngSwitchCase="'A'"&gt;Var is A&lt;/div&gt;</p><p class="daima">　&lt;div *ngSwitchCase="'B'"&gt;Var is B&lt;/div&gt;</p><p class="daima">　&lt;div *ngSwitchDefault&gt;Var is something else&lt;/div&gt;</p><p class="daima">&lt;/div&gt;</p><p class="content">如果想要处理新值C，只需要插入一行：</p><p class="daima">&lt;div class="container" [ngSwitch]="myVar"&gt;</p><p class="daima">　&lt;div *ngSwitchCase="'A'"&gt;Var is A&lt;/div&gt;</p><p class="daima">　&lt;div *ngSwitchCase="'B'"&gt;Var is B&lt;/div&gt;</p><p class="daima">　&lt;div *ngSwitchCase="'C'"&gt;Var is C&lt;/div&gt;</p><p class="daima">　&lt;div *ngSwitchDefault&gt;Var is something else&lt;/div&gt;</p><p class="daima">&lt;/div&gt;</p><p class="content">不需要修改默认（即<b>备用</b>）条件。</p><p class="content">ngSwitchDefault元素是可选的。如果我们不用它，那么当myVar没有匹配到任何期望的值时就不会渲染任何东西。</p><p class="content">你也可以为不同的元素声明同样的*ngSwitchCase值，这样就可以多次匹配同一个值了。例子如下：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_switch/ng_switch.ts</b></p><p class="daima">　template：`</p><p class="daima">　　&lt;h4 class="ui horizontal divider header"&gt;</p><p class="daima">　　　Current choice is {{ choice }}</p><p class="daima">　　&lt;/h4&gt;</p><p class="daima">　　&lt;div class="ui raised segment"&gt;</p><p class="daima">　　　&lt;ul [ngSwitch]="choice"&gt;</p><p class="daima">　　　　&lt;li *ngSwitchCase="1"&gt;First choice&lt;/li&gt;</p><p class="daima">　　　　&lt;li *ngSwitchCase="2"&gt;Second choice&lt;/li&gt;</p><p class="daima">　　　　&lt;li *ngSwitchCase="3"&gt;Third choice&lt;/li&gt;</p><p class="daima">　　　　&lt;li *ngSwitchCase="4"&gt;Fourth choice&lt;/li&gt;</p><p class="daima">　　　　&lt;li *ngSwitchCase="2"&gt;Second choice, again&lt;/li&gt;</p><p class="daima">　　　　&lt;li *ngSwitchDefault&gt;Default choice&lt;/li&gt;</p><p class="daima">　　　&lt;/ul&gt;</p><p class="daima">　　&lt;/div&gt;</p><p class="daima">　　&lt;div style="margin-top：20px;"&gt;</p><p class="daima">　　　&lt;button class="ui primary button"（click）="nextChoice（）"&gt;</p><p class="daima">　　　　Next choice</p><p class="daima">　　　&lt;/button&gt;</p><p class="daima">　　&lt;/div&gt;</p><p class="daima">　`</p><p class="content">在上面的例子中，当choice的值是2的时候，第2个和第5个li都会被渲染。</p><p class="sectionTitle biaoti3"><a id="sec004"></a>4.4 ngStyle</p><p class="content">使用ngStyle指令，可以通过Angular表达式给特定的DOM元素设定CSS属性。</p><p class="content">该指令最简单的用法就是[style.&lt;cssproperty&gt;]="value"的形式，下面是一个例子。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_style/ng_style.ts</b></p><p class="daima">　　　&lt;div [style.background-color]="'yellow'"&gt;</p><p class="daima">　　　　Uses fixed yellow background</p><p class="daima">　　　&lt;/div&gt;</p><p class="content">这个代码片段就是使用ngStyle指令把CSS的background-color属性设置为字符串字面量yellow。</p><p class="content">另一种设置固定值的方式就是使用ngStyle属性，使用键值对来设置每个属性。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_style/ng_style.ts</b></p><p class="daima">　　　&lt;div [ngStyle]="{color：'white', 'background-color'：'blue'}"&gt;</p><p class="daima">　　　　Uses fixed white text on blue background</p><p class="daima">　　　&lt;/div&gt;</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t18559/108/2587195628/17417/8ceb743d/5b03d540N559a889f.jpg" class="enlarge" alt="" href="./image/a-9.jpg" /></p><p class="content">注意，在ngStyle的说明中，我们对background-color使用了单引号，但却没有对color使用。这是为什么呢？因为ngStyle的参数是一个JavaScript对象，而color是一个合法的键，不需要引号。但是在background-color中，连字符是不允许出现在对象的键名当中的，除非它是一个字符串，因此使用了引号。</p><p class="content">通常情况下，我尽量不会对对象的键使用引号，除非不得不用。</p><p class="content">我们在这里同时设置了color和background-color属性。</p><p class="content">但ngStyle指令真正的能力在于使用动态值。</p><p class="content">在这个例子中，我们定义了两个输入框。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_style/ng_style.ts</b></p><p class="daima">　　　&lt;div class="ui input"&gt;</p><p class="daima">　　　　&lt;input type="text" name="color" value="{{color}}" #colorinput&gt;</p><p class="daima">　　　&lt;/div&gt;</p><p class="daima">　　　&lt;div class="ui input"&gt;</p><p class="daima">　　　　&lt;input type="text" name="fontSize" value="{{fontSize}}" #fontinput&gt;</p><p class="daima">　　　&lt;/div&gt;</p><p class="daima">　　　&lt;button class="ui primary button"（click）="apply（colorinput.value, fontinput\</p><p class="daima">　.value）"&gt;</p><p class="daima">　　　　Apply settings</p><p class="daima">　　　&lt;/button&gt;</p><p class="content">然后使用它们的值来设置三个元素的CSS属性。</p><p class="content">在第一个元素中，我们基于输入框的值来设定字体大小。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_style/ng_style.ts</b></p><p class="daima">　　&lt;div&gt;</p><p class="daima">　　　&lt;span [ngStyle]="{color：'red'}" [style.font-size.px]="fontSize"&gt;</p><p class="daima">　　　　red text</p><p class="daima">　　　&lt;/span&gt;</p><p class="daima">　　&lt;/div&gt;</p><p class="content">注意，我们在某些情况下必须指定单位。例如，把font-size设置为12不是合法的CSS，必须指定一个单位，比如12px或者1.2em。Angular提供了一个便捷语法用来指定单位：这里我们使用的格式是[style.fontSize.px]。</p><p class="content">后缀.px表明我们设置font-size属性值以像素为单位。你完全可以把它替换为[style.font-size.em]，以相对长度为单位来表示字体大小；还可以使用[style.fontSize.％]，以百分比为单位。</p><p class="content">另外两个元素使用#colorinput的值来设置文字颜色和背景颜色。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_style/ng_style.ts</b></p><p class="daima">　　&lt;h4 class="ui horizontal divider header"&gt;</p><p class="daima">　　　ngStyle with object property from variable</p><p class="daima">　　&lt;/h4&gt;</p><p class="daima">　　&lt;div&gt;</p><p class="daima">　　　&lt;span [ngStyle]="{color：color}"&gt;</p><p class="daima">　　　　{{ color }} text</p><p class="daima">　　　&lt;/span&gt;</p><p class="daima">　　&lt;/div&gt;</p><p class="daima">　　&lt;h4 class="ui horizontal divider header"&gt;</p><p class="daima">　　　style from variable</p><p class="daima">　　&lt;/h4&gt;</p><p class="daima">　　&lt;div [style.background-color]="color"</p><p class="daima">　　　　 style="color：white;"&gt;</p><p class="daima">　　　{{ color }} background</p><p class="daima">　　&lt;/div&gt;</p><p class="content">这样，当我们点击Apply settings按钮时，就会调用方法来设置新的值。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_style/ng_style.ts</b></p><p class="daima">　apply（color：string, fontSize：number）{</p><p class="daima">　　this.color = color;</p><p class="daima">　　this.fontSize = fontSize;</p><p class="daima">　}</p><p class="content">与此同时，文本颜色和字体大小都通过NgStyle指令作用在元素上了。</p><p class="sectionTitle biaoti3"><a id="sec005"></a>4.5 ngClass</p><p class="content">ngClass指令在HTML模板中用ngClass属性来表示，让你能动态设置和改变一个给定DOM元素的CSS类。</p><p class="reference"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t20827/10/215994487/12231/293f6125/5b03d541Ndff69dec.jpg" class="inline1" alt="" href="./image/a-3.jpg" />　如果你用过AngularJS，会发现ngClass指令和过去在AngularJS中的ngClass所做的事是非常相似的。</p><p class="content">使用这个指令的第一种方式是传入一个对象字面量。该对象希望以类名作为键，而值应该是一个用来表明是否应该应用该类的真/假值。</p><p class="content">假设我们有一个叫作bordered的CSS类，用来给元素添加一个黑色虚线边框。</p><p class="reference"><b>code/built_in_directives/app/css/styles.scss</b></p><p class="daima">.bordered {</p><p class="daima">　border：1px dashed black;</p><p class="daima">　background-color：#eee;</p><p class="daima">}</p><p class="content">我们来添加两个div元素：一个一直都有bordered类（因此一直有边框），而另一个永远都不会有。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">　&lt;div [ngClass]="<b>ordered：false</b>"&gt;This is never bordered&lt;/div&gt;</p><p class="daima">　&lt;div [ngClass]="<b>ordered：true</b>"&gt;This is always bordered&lt;/div&gt;</p><p class="content">如预期一样，两个div应该是如图4-1这样渲染的。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t20350/9/215201328/18384/4badaa3a/5b03d541Nd6dec9d9.jpg" class="enlarge" alt="" href="./image/a-34.jpg" /></p><p class="descrip"><b>图4-1　ngClass指令的简单用法</b></p><p class="content">当然，使用ngClass指令来动态分配类会有用得多。</p><p class="content">为了动态使用它，我们添加了一个变量作为对象的值：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">　&lt;div [ngClass]="<b>ordered：isBordered</b>"&gt;</p><p class="daima">　 Using object literal．Border {{ isBordered ? "ON"："OFF" }}</p><p class="daima">　&lt;/div&gt;</p><p class="content">或者在组件中定义该对象：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">export class NgClassSampleApp {</p><p class="daima">　isBordered：boolean;</p><p class="daima">　classesObj：Object;</p><p class="daima">　classList：string[];</p><p class="content">并直接使用它：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">　&lt;div [ngClass]="classesObj"&gt;</p><p class="daima">　　Using object var．Border {{ classesObj.bordered ? "ON"："OFF" }}</p><p class="daima">　&lt;/div&gt;</p><p class="reference"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t20827/10/215994487/12231/293f6125/5b03d541Ndff69dec.jpg" class="inline1" alt="" href="./image/a-3.jpg" />　再次强调，当你使用像bordered-box这种包含连字符的类名时需要小心。JavaScript对象不允许字面量的键出现连字符。如果确实需要，那就必须像这样用字符串作为键：</p><p class="daima">&lt;div [ngClass]="{'bordered-box'：false}"&gt;……&lt;/div&gt;</p><p class="content">我们也可以使用一个类名列表来指定哪些类名会被添加到元素上。为此，我们可以传入一个数组型字面量：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">　&lt;div class="base" [ngClass]="['blue', 'round']"&gt;</p><p class="daima">　　This will always have a blue background and</p><p class="daima">　　round corners</p><p class="daima">　&lt;/div&gt;</p><p class="content">或者在组件中声明一个数组对象：</p><p class="daima">　　this.classList = ['blue', 'round'];</p><p class="content">并把它传进来：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">　&lt;div class="base" [ngClass]="classList"&gt;</p><p class="daima">　　This is {{ classList.indexOf（'blue'）&gt; -1 ? ""："NOT" }} blue</p><p class="daima">　　and {{ classList.indexOf（'round'）&gt; -1 ? ""："NOT" }} round</p><p class="daima">　&lt;/div&gt;</p><p class="content">在上个例子中，[ngClass]分配的类名和通过HTML的class属性分配的已存在类名都是生效的。</p><p class="content">最后添加到元素的类总会是HTML属性class中的类和[ngClass]指令求值结果得到的类的集合。</p><p class="content">在这个例子中：</p><p class="reference"><b>code/built_in_directives/app/ts/ng_class/ng_class.ts</b></p><p class="daima">　&lt;div class="base" [ngClass]="['blue', 'round']"&gt;</p><p class="daima">　　This will always have a blue background and</p><p class="daima">　　round corners</p><p class="daima">　&lt;/div&gt;</p><p class="content">元素有全部的三个类：HTML的class属性提供的base，以及通过[ngClass]分配的blue和round（如图4-2所示）。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t19489/338/2644563603/51276/ff8fc580/5b03d541N11ddd70a.jpg" class="enlarge" alt="" href="./image/a-35.jpg" /></p><p class="descrip"><b>图4-2　来自属性和指令的CSS类</b></p><p class="sectionTitle biaoti3"><a id="sec006"></a>4.6 ngFor</p><p class="content">这个指令的任务是<b>重复一个给定的DOM元素</b>（或一组DOM元素），每次重复都会从数组中取一个不同的值。</p><p class="reference"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t20827/10/215994487/12231/293f6125/5b03d541Ndff69dec.jpg" class="inline1" alt="" href="./image/a-3.jpg" />　这个指令是AngularJS中ng-repeat的继任者。</p><p class="content">它的语法是*ngFor="let item of items"。</p><p class="content">●let item语法指定一个用来接收items数组中每个元素的（模板）变量。</p><p class="content">●items是来自组件控制器的一组项的集合。</p><p class="content">要阐明这一点，我们来看一下代码示例。我们在组件控制器中声明了一个城市的数组：</p><p class="daima">this.cities = ['Miami', 'Sao Paulo', 'New York'];</p><p class="content">然后在模板中有如下的HTML片段。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　&lt;h4 class="ui horizontal divider header"&gt;</p><p class="daima">　　Simple list of strings</p><p class="daima">　&lt;/h4&gt;</p><p class="daima">　&lt;div class="ui list" *ngFor="let c of cities"&gt;</p><p class="daima">　　&lt;div class="item"&gt;{{ c }}&lt;/div&gt;</p><p class="daima">　&lt;/div&gt;</p><p class="content">它会如你期望的那样在div中渲染每一个城市，如图4-3所示。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t19150/82/2663110972/11772/cad98e1d/5b03d540Na6e4ae2c.jpg" class="enlarge" alt="" href="./image/a-36.jpg" /></p><p class="descrip"><b>图4-3　使用ngFor指令的结果</b></p><p class="content">我们还可以这样迭代一个对象数组。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　　this.people = [</p><p class="daima">　　　{ name：'Anderson', age：35, city：'Sao Paulo' },</p><p class="daima">　　　{ name：'John', age：12, city：'Miami' },</p><p class="daima">　　　{ name：'Peter', age：22, city：'New York' }</p><p class="daima">　　];</p><p class="content">然后根据每一行数据渲染出一个表格。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　&lt;h4 class="ui horizontal divider header"&gt;</p><p class="daima">　　List of objects</p><p class="daima">　&lt;/h4&gt;</p><p class="daima">　&lt;table class="ui celled table"&gt;</p><p class="daima">　　&lt;thead&gt;</p><p class="daima">　　　&lt;tr&gt;</p><p class="daima">　　　　&lt;th&gt;Name&lt;/th&gt;</p><p class="daima">　　　　&lt;th&gt;Age&lt;/th&gt;</p><p class="daima">　　　　&lt;th&gt;City&lt;/th&gt;</p><p class="daima">　　　&lt;/tr&gt;</p><p class="daima">　　&lt;/thead&gt;</p><p class="daima">　　&lt;tr *ngFor="let p of people"&gt;</p><p class="daima">　　　&lt;td&gt;{{ p.name }}&lt;/td&gt;</p><p class="daima">　　　&lt;td&gt;{{ p.age }}&lt;/td&gt;</p><p class="daima">　　　&lt;td&gt;{{ p.city }}&lt;/td&gt;</p><p class="daima">　　&lt;/tr&gt;</p><p class="daima">　&lt;/table&gt;</p><p class="content">结果如图4-4所示。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t21025/26/214291858/29593/2733492b/5b03d541N1110583b.jpg" class="enlarge" alt="" href="./image/a-37.jpg" /></p><p class="descrip"><b>图4-4　渲染对象数组</b></p><p class="content">我们还可以使用嵌套数组。如果想根据城市进行分组，可以定义一个新对象数组。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　　this.peopleByCity = [</p><p class="daima">　　　{</p><p class="daima">　　　　city：'Miami',</p><p class="daima">　　　　people：[</p><p class="daima">　　　　　{ name：'John', age：12 },</p><p class="daima">　　　　　{ name：'Angel', age：22 }</p><p class="daima">　　　　]</p><p class="daima">　　　},</p><p class="daima">　　　{</p><p class="daima">　　　　city：'Sao Paulo',</p><p class="daima">　　　　people：[</p><p class="daima">　　　　　{ name：'Anderson', age：35 },</p><p class="daima">　　　　　{ name：'Felipe', age：36 }</p><p class="daima">　　　　]</p><p class="daima">　　　}</p><p class="daima">　　];</p><p class="daima">　};</p><p class="content">然后可以使用ngFor为每个城市渲染一个h2标签。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　&lt;div *ngFor="let item of peopleByCity"&gt;</p><p class="daima">　　&lt;h2 class="ui header"&gt;{{ item.city }}&lt;/h2&gt;</p><p class="content">并且使用一个嵌套指令对这个城市中的人们进行迭代。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　　&lt;table class="ui celled table"&gt;</p><p class="daima">　　　&lt;thead&gt;</p><p class="daima">　　　　&lt;tr&gt;</p><p class="daima">　　　　　&lt;th&gt;Name&lt;/th&gt;</p><p class="daima">　　　　　&lt;th&gt;Age&lt;/th&gt;</p><p class="daima">　　　　&lt;/tr&gt;</p><p class="daima">　　　&lt;/thead&gt;</p><p class="daima">　　　&lt;tr *ngFor="let p of item.people"&gt;</p><p class="daima">　　　　&lt;td&gt;{{ p.name }}&lt;/td&gt;</p><p class="daima">　　　　&lt;td&gt;{{ p.age }}&lt;/td&gt;</p><p class="daima">　　　&lt;/tr&gt;</p><p class="daima">　　&lt;/table&gt;</p><p class="content">下面是模板代码的最终结果。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　　&lt;h4 class="ui horizontal divider header"&gt;</p><p class="daima">　　　Nested data</p><p class="daima">　　&lt;/h4&gt;</p><p class="daima">　　&lt;div *ngFor="let item of peopleByCity"&gt;</p><p class="daima">　　　&lt;h2 class="ui header"&gt;{{ item.city }}&lt;/h2&gt;</p><p class="daima">　　　&lt;table class="ui celled table"&gt;</p><p class="daima">　　　　&lt;thead&gt;</p><p class="daima">　　　　　&lt;tr&gt;</p><p class="daima">　　　　　　&lt;th&gt;Name&lt;/th&gt;</p><p class="daima">　　　　　　&lt;th&gt;Age&lt;/th&gt;</p><p class="daima">　　　　　&lt;/tr&gt;</p><p class="daima">　　　　&lt;/thead&gt;</p><p class="daima">　　　　&lt;tr *ngFor="let p of item.people"&gt;</p><p class="daima">　　　　　&lt;td&gt;{{ p.name }}&lt;/td&gt;</p><p class="daima">　　　　　&lt;td&gt;{{ p.age }}&lt;/td&gt;</p><p class="daima">　　　　&lt;/tr&gt;</p><p class="daima">　　　&lt;/table&gt;</p><p class="daima">　　&lt;/div&gt;</p><p class="content">它会为每个城市渲染一个表格，如图4-5所示。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t18478/341/2563219302/39162/4d914c74/5b03d541N839af681.jpg" class="enlarge" alt="" href="./image/a-38.jpg" /></p><p class="descrip"><b>图4-5　渲染嵌套数组</b></p><p class="listTitle1 biaoti8">获取索引</p><p class="content">在迭代数组时，我们可能也要获取每一项的索引。</p><p class="content">我们可以在ngFor指令的值中插入语法let idx = index并用分号分隔开，这样就可以获取索引了。这时候，Angular会把当前的索引分配给我们提供的变量（在这里是变量idx）。</p><p class="reference"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t17728/48/2715397358/11728/16045511/5b03d541N9720f866.jpg" class="inline1" alt="" href="./image/a-4.jpg" />　注意，和JavaScript一样，索引都是从0开始的。因此第一个元素的索引是0，第二个是1，以此类推。</p><p class="content">对我们的第一个例子稍加改动，添加代码段let num = index。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_for/ng_for.ts</b></p><p class="daima">　&lt;div class="ui list" *ngFor="let c of cities; let num = index"&gt;</p><p class="daima">　　&lt;div class="item"&gt;{{ num+1 }} - {{ c }}&lt;/div&gt;</p><p class="daima">　&lt;/div&gt;</p><p class="content">它会在城市的名称前面添加序号，如图4-6所示。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t21841/338/204557919/11730/dd0fb0e9/5b03d541Naf5d796f.jpg" class="enlarge" alt="" href="./image/a-39.jpg" /></p><p class="descrip"><b>图4-6　使用索引</b></p><p class="sectionTitle biaoti3"><a id="sec007"></a>4.7 ngNonBindable</p><p class="content">当我们想告诉Angular<b>不要</b>编译或者绑定页面中的某个特殊部分时，要使用ngNodBindable指令。</p><p class="content">假设我们想在模板中渲染纯文本{{ content }}。通常情况下，这段文本会被绑定到变量content的值，因为我们使用了{{ }}模板语法。</p><p class="content">那该如何渲染出纯文本{{ content }}呢？可以使用ngNonBindable指令。</p><p class="content">假设我们想要用一个div来渲染变量content的内容，紧接着输出文本&lt;- this is what {{ content }} rendered来指向变量实际的值。</p><p class="content">为了做到这一点，要使用下面的模板。</p><p class="reference"><b>code/built_in_directives/app/ts/ng_non_bindable/ng_non_bindable.ts</b></p><p class="daima">　template：`</p><p class="daima">　&lt;div class='ngNonBindableDemo'&gt;</p><p class="daima">　　&lt;span class="bordered"&gt;{{ content }}&lt;/span&gt;</p><p class="daima">　　&lt;span class="pre" ngNonBindable&gt;</p><p class="daima">　　　&amp;larr; This is what {{ content }} rendered</p><p class="daima">　　&lt;/span&gt;</p><p class="daima">　&lt;/div&gt;</p><p class="daima">　`</p><p class="content">有了ngNonBindable属性，Angular不会编译第二个span里的内容，而是原封不动地将其显示出来（如图4-7所示）。</p><p class="center"><img src="https://img30.360buyimg.com/ebookadmin/jfs/t17662/146/2661684673/21537/dd2d1f10/5b03d541N56f0dc8c.jpg" class="enlarge" alt="" href="./image/a-40.jpg" /></p><p class="descrip"><b>图4-7　使用ngNonBindable的结果</b></p><p class="sectionTitle biaoti3"><a id="sec008"></a>4.8 总结</p><p class="content">Angular的核心指令数量很少，但我们却能通过组合这些简单的指令来创建五花八门的应用。</p></body></html>